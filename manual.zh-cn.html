<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>HexJS使用手册</title>
        <meta name="author" content="Edgar Hoo, edgarhoo.net"/>
        <meta name="date" content="Aug 26, 2011"/>
        <link rel="stylesheet" href="http://static.edgar.im/app/highlight/sh.css"/>
    </head>
    <body>
        <h1>HexJS使用手册</h1>
        <nav>
            <ul>
                <li><a href="manual.html">Manual</a></li>
                <li><a href="https://github.com/edgarhoo/hexjs">Git Repo</a></li>
                <li><a href="test.html?hexjs.debug=true">Test</a></li>
            </ul>
        </nav>
        <article>
            <h1>define</h1>
            <pre class="sh_javascript">
    // 定义module
    hexjs.define( 'module-name', function( require, exports, module ){
        //todo something
    } );
            </pre>
            <pre class="sh_javascript">
    // 通过对象定义module，但此对象必须含有名为init的初始化函数
    hexjs.define( 'module-name', {
        init: function( require, exports, module ){
            //todo something
        },
        _other: function(){}
    } );
            </pre>
            <pre class="sh_javascript">
    // 定义匿名module
    hexjs.define( function( require, exports, module ){
        //todo something
    } );
            </pre>
        </article>
        <article>
            <h1>register</h1>
            <p>注册module时，选择执行类型。多次注册同一module，只执行第一次</p>
            <pre class="sh_javascript">
    // 注册module，DOM ready之后执行
    hexjs.register('module-name');
            </pre>
            <pre class="sh_javascript">
    // 注册时，在module名前加一个波浪号(英文~)，则此module即刻执行
    hexjs.register('~module-name');
            </pre>
            <pre class="sh_javascript">
    // 注册匿名module，DOM ready之后执行
    hexjs.define( function( require, exports, module ){
        //todo something
    } ).register();
            </pre>
            <pre class="sh_javascript">
    // 注册匿名module，即刻执行
    hexjs.define( function( require, exports, module ){
        //todo something
    } ).register('~');
            </pre>
            <pre class="sh_javascript">
    // 注册多个module
    hexjs.register( ['module-a', 'module-b', '~module-c'] );
            </pre>
        </article>
        <article>
            <h1>exports</h1>
            <pre class="sh_javascript">
    // 由exports输出API
    hexjs.define( 'module-a', function( require, exports, module ){
        exports.a = new Date().getTime(); // --> 1314289663337
    } );
            </pre>
            <pre class="sh_javascript">
    // 由return输出API
    hexjs.define( 'module-b', function( require, exports, module ){
        return {
            b: 'bbb'
        }
    } );
            </pre>
            <pre class="sh_javascript">
    // return输出将覆盖exports输出
    hexjs.define( 'module-c', function( require, exports, module ){
        exports.c = '111';
        return {
            c: 'ccc'
        }
    } );
            </pre>
            <pre class="sh_javascript wrong">
    // 不能直接覆盖exports
    hexjs.define( 'module-c', function( require, exports, module ){
        exports = {
            a: '111'
        };
    } );
            </pre>
        </article>
        <article>
            <h1>require</h1>
            <p>引用module以获得该module API，若注册此module则不返回API</p>
            <pre class="sh_javascript">
    // 引用module-a
    // 多次引用同一module，只第一次引用时执行，其后引用只返回API
    hexjs.define( 'module-name', function( require, exports, module ){
        var a = require('module-a');
        // a.a --> '1314289663337'
    } );
            </pre>
            <pre class="sh_javascript">
    // 增加重新执行选项，module将重新被执行，覆盖原执行结果及其输出API
    hexjs.define( 'module-name', function( require, exports, module ){
        var a = require('module-a', true);
        // a.a --> '1314289701153'
    } );
            </pre>
        </article>
        <article>
            <h1>module</h1>
            <h2>module.id</h2>
            <pre class="sh_javascript">
    // module.id返回当前module名
    hexjs.define( 'module-d', function( require, exports, module ){
        console.info( module.id ); // --> module-d
    } );
            </pre>
            <h2>module.exports</h2>
            <pre class="sh_javascript">
    // 以module.exports来输出API
    hexjs.define( 'module-e', function( require, exports, module ){
        module.exports = {
            a: 'aaa'
        };
    } );
            </pre>
            <h2>module.constructor</h2>
            <pre class="sh_javascript">
    // 给module构造器添加方法
    hexjs.define( 'module-constructor', function( require, exports, module ){
        var M = module.constructor;
        
        M.prototype.getId = function(){
            return module.id;
        };
    } );
    
    hexjs.define(function(require, exports, module ){
        require('module-constructor');
        console.info( module.getId() ); // --> 'module-constructor'
    } ).register();
            </pre>
        </article>
        <article>
            <h1>debug</h1>
            <pre class="sh_html">
    &lt;!-- 在访问页面时加上hexjs.debug=ture即进入debug模式 -->
    <a href="http://hexjs.edgarhoo.org/test.html?hexjs.debug=true">http://hexjs.edgarhoo.org/test.html?hexjs.debug=true</a>
            </pre>
        </article>
        <script src="http://static.edgar.im/app/highlight/sh.js"></script>
    </body>
</html>
