<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>HexJS Unit Testing</title>
        <script src="../src/hex.js"></script>
        <script src="http://static.edgarhoo.com/sys/jquery/jquery.js"></script>
        <script>
            /**
             * @module ut
             * */
            hexjs.define( 'ut', function( require, exports, module ){
                
                var output = function( fn, type, color ){
                    jQuery( '#' + fn ).css( 'color',  color ).html( fn + ' ' + type );
                };
                
                exports.print = function( message, fn ){
                    if ( !!message ){
                        output( fn, 'pass', 'green' );
                    } else {
                        output( fn, 'fail', 'red' );
                    }
                };
                
            } );
            
            
            /**
             * @module register-ready
             * */
            hexjs.define( 'register-ready', function( require ){
                require('ut').print( true, 'register-ready' );
            } );


            /**
             * @module register-now
             * */
            hexjs.define( 'register-now', function( require, exports ){
                exports.isEmpty = !jQuery('#register-ready').html();
            } );


            /**
             * @module define-repeat
             * */
            hexjs.define( 'define-repeat', function( require, exports ){
                exports.variable = 'repeat';
            } );
            
            hexjs.define( 'define-repeat', function( require, exports ){
                exports.variable = 'define';
            } );


            /**
             * @module define-object-init
             * */
            hexjs.define( 'define-object-init', {
                init: function( require, exports, module ){
                    exports.variable = this._variable;
                },
                _variable: 'define-object-init'
                
            } );


            /**
             * @module register-multi
             * */
            hexjs.define( 'register-multi', function( require, exports ){
                var variable = 0;
                
                exports.plus = function(){
                    variable++;
                };
                exports.get = function(){
                    return variable;
                };
            } );
            hexjs.define( 'register-multi-a', function( require ){
                require('register-multi').plus();
            } );
            hexjs.define( 'register-multi-b', function( require ){
                require('register-multi').plus();
            } );


            /**
             * @module require
             * */
            hexjs.define( 'require', function( require ){
                return require('ut');
            } );

            /**
             * @module require-refresh
             * */
            hexjs.define( 'require-refresh-pre', function( require, exports ){
                var variable = 1;
                exports.plus = function(){
                    variable++;
                    return variable;
                };
            } );
            hexjs.define( 'require-refresh', function( require, exports ){
                exports.variable = require('require-refresh-pre').plus();
            } );
            
            /**
             * @module require-readonly
             * */
            hexjs.define( 'require-readonly', function( require ){
                require.variable = 'require-readonly';
            } );
            
            /**
             * @module require-value-readonly
             * */
            hexjs.define( 'require-value-readonly-pre', function( require, exports ){
                exports.variable = 0;
            } );
            hexjs.define( 'require-value-readonly', function( require, exports ){
                require('require-value-readonly-pre').variable = 1;
                exports.variable = require('require-value-readonly-pre').variable;
            } );

            /**
             * @module exports
             * */
            hexjs.define( 'exports', function( require, exports ){
                exports.variable = 'exports';
            } );


            /**
             * @module exports-return
             * */
            hexjs.define( 'exports-return', function(){
                return {
                    variable: 'exports-return'
                }
            } );


            /**
             * @module exports-return-simplify
             * */
            hexjs.define( 'exports-return-simplify', {
                variable: 'exports-return-simplify'
            } );


            /**
             * @module exports-return-cover
             * */
            hexjs.define( 'exports-return-cover', function( require, exports ){
                exports.variable = 'exports';
                return {
                    variable: 'exports-return-cover'
                }
            } );


            /**
             * @module module-exports
             * */
            hexjs.define( 'module-exports', function( require, exports, module ){
                module.exports =  {
                    variable: 'module-exports'
                }
            } );


            /**
             * @module module-id
             * */
            hexjs.define( 'module-id', function( require, exports, module ){
                exports.id = module.id;
            } );


            /**
             * @module module-constructor
             * */
            hexjs.define( 'module-constructor', function( require, exports, module ){
                var M = module.constructor;
                
                M.prototype.getId = function(){
                    return module.id;
                };
            } );
            
            
            /**
             * @module noConflict
             * */
            hexjs.define( 'noConflict-false', function(){
                hexjs.noConflict(false);
            } );
            hexjs.define( 'noConflict-true', function(){
                hexjs.noConflict(true);
            } );
            hexjs.define( 'noConflict-undefined', function(){
                window.hexjsTemp = hexjs.noConflict();
            } );
            
            
            
            hexjs.register('register-ready');
            
            hexjs.register('~register-now');
            
            hexjs.define(function(require){
                require('ut').print( require('register-now').isEmpty, 'register-now' );
            }).register();
            
            hexjs.register( ['register-multi-a','~register-multi-b'] );
            
            hexjs.define(function(require){
                require('ut').print( require('define-repeat').variable === 'repeat', 'define-not-repeat' );
            }).register();
            
            hexjs.define(function(require){
                require('ut').print( require('define-object-init').variable === 'define-object-init', 'define-object-init' );
            } ).register();
            
            hexjs.define(function(require){
                require('require').print( true, 'require');
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('require-refresh').variable !== require('require-refresh',true).variable, 'require-refresh' );
            }).register();
            
            hexjs.define(function(require){
                require('require-readonly');
                require('ut').print( require.variable !== 'require-readonly', 'require-readonly' );
            }).register();
            
            hexjs.define(function(require){
                require('ut').print( require('require-value-readonly-pre').variable === require('require-value-readonly').variable, 'require-value-readonly' );
            }).register();
            
            hexjs.define(function(require){
                require('ut').print( require('exports').variable === 'exports', 'exports' );
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('exports-return').variable === 'exports-return', 'exports-return' );
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('exports-return-simplify').variable === 'exports-return-simplify', 'exports-return-simplify' );
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('exports-return-cover').variable === 'exports-return-cover', 'exports-return-cover' );
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('module-exports').variable === 'module-exports', 'module-exports' );
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('module-id').id === 'module-id', 'module-id' );
            } ).register();
            
            hexjs.define(function( require, exports, module ){
                require('module-constructor');
                require('ut').print( module.getId() === 'module-constructor', 'module-constructor' );
            } ).register();
            
            hexjs.define(function(require){
                require('ut').print( require('register-multi').get() === 2, 'register-multi' );
            }).register();
            
            hexjs.define(function(require){
                hexjs.register('~noConflict-false');
                require('ut').print( define === hexjs.define && register === hexjs.register, 'noConflict-false' );
            }).register();
            
            hexjs.define(function(require){
                hexjs.register('~noConflict-true');
                require('ut').print( define !== hexjs.define && register !== hexjs.register, 'noConflict-true' );
            }).register();
            
            hexjs.define(function(require){
                hexjs.register('~noConflict-undefined');
                require('ut').print( hexjs === undefined, 'noConflict-undefined' );
                window.hexjs = hexjsTemp;
            }).register();
        </script>
    </head>
    <body style="width:800px;margin:0 auto;">
        <h1>HexJS Unit Testing</h1>
        <ul id="test-output">
            <li id="register-ready"></li>
            <li id="register-now"></li>
            <li id="define-not-repeat"></li>
            <li id="define-object-init"></li>
            <li id="require"></li>
            <li id="require-refresh"></li>
            <li id="require-readonly"></li>
            <li id="require-value-readonly"></li>
            <li id="exports"></li>
            <li id="exports-return"></li>
            <li id="exports-return-simplify"></li>
            <li id="exports-return-cover"></li>
            <li id="module-exports"></li>
            <li id="module-id"></li>
            <li id="module-constructor"></li>
            <li id="register-multi"></li>
            <li id="noConflict-false"></li>
            <li id="noConflict-true"></li>
            <li id="noConflict-undefined"></li>
        </ul>
        <script src="http://static.edgarhoo.com/app/ga/org.js"></script>
    </body>
</html>
